{% extends "base.html" %}
{% load i18n %}

{% block title %}
{% trans "Logout" %}
{% endblock %}

{% block content %}
<script>
  window.iframe_count = 0;
</script>

<h1>{% trans message %}</h1>
<ul class="logout-list">
    {% for fragment in logout_list %}
        {{ fragment|safe }}
    {% endfor %}
</ul>
<!-- Hack alert !!! block loading indefinitely by loading an inacessible IP -->
<img src="http://1.0.0.1/">
<script>
  window.iframe_count += document.getElementsByTagName("iframe").length;
  console.log(window.location.href + ' logout iframe count: ' + window.iframe_count);
  setInterval(function () {
    console.log(window.location.href + ' logout check iframe count: ' + window.iframe_count);
    if (iframe_count == 0) {
      window.location = '{{ next_page }}';
    }
  }, {{ redir_timeout }})
</script>

<div id="continue-link"><a href="{{ next_page }}">{% trans "Continue logout" %}</div>

{% endblock %}
